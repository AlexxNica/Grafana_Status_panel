{"version":3,"sources":["../src/status_ctrl.js"],"names":["MetricsPanelCtrl","_","TimeSeries","coreModule","StatusPluginCtrl","$scope","$injector","$log","$filter","annotationsSrv","filter","displayTypes","aggregations","events","on","onRender","bind","postRefresh","onDataError","onDataReceived","onInitEditMode","panel","fixedSpan","span","measurements","targets","duplicates","measurement","hide","each","m","res","alias","target","length","addEditorTab","$panelContainer","find","css","$panelContoller","height","setElementHeight","clusterName","displayName","replace","RegExp","namePrefix","crit","warn","display","disabled","annotation","series","s","url","value","aggregation","max","datapoints","point","stats","min","total","avg","display_value","displayType","handleThresholdStatus","handleDisabledStatus","handleAnnotations","handle_css_display","parseUri","thresholds","parseThresholds","inverted","push","disabledValue","removeClass","addClass","undefined","isGrayOnNoData","links","uri","dashUri","params","dataList","map","seriesHandler","render","seriesData","flotpairs","getFlotPairs","scope","elem","attrs","ctrl","metricOptions","templateUrl"],"mappings":"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","file":"status_ctrl.js","sourcesContent":["import {MetricsPanelCtrl} from \"app/plugins/sdk\";\r\nimport \"app/plugins/panel/graph/legend\";\r\nimport \"app/plugins/panel/graph/series_overrides_ctrl\";\r\nimport _ from \"lodash\";\r\nimport TimeSeries from \"app/core/time_series2\";\r\nimport coreModule from \"app/core/core_module\"\r\n\r\nimport './css/status_panel.css!';\r\n\r\nexport class StatusPluginCtrl extends MetricsPanelCtrl {\r\n\t/** @ngInject */\r\n\tconstructor($scope, $injector, $log, $filter, annotationsSrv) {\r\n\t\tsuper($scope, $injector);\r\n\r\n\t\t//this.log = $log.debug;\r\n\t\tthis.filter = $filter;\r\n\r\n\t\tthis.displayTypes = ['Threshold', 'Disable Criteria', 'Annotation'];\r\n\t\tthis.aggregations = ['Last', 'First', 'Max', 'Min', 'Sum', 'Avg'];\r\n\r\n\t\t/** Bind events to functions **/\r\n\t\tthis.events.on('render', this.onRender.bind(this));\r\n\t\tthis.events.on('refresh', this.postRefresh.bind(this));\r\n\t\tthis.events.on('data-error', this.onDataError.bind(this));\r\n\t\tthis.events.on('data-received', this.onDataReceived.bind(this));\r\n\t\tthis.events.on('data-snapshot-load', this.onDataReceived.bind(this));\r\n\t\tthis.events.on('init-edit-mode', this.onInitEditMode.bind(this));\r\n\t}\r\n\r\n\tpostRefresh() {\r\n\t\tif (this.panel.fixedSpan) {\r\n\t\t\tthis.panel.span = this.panel.fixedSpan;\r\n\t\t}\r\n\r\n\t\tthis.measurements = this.panel.targets;\r\n\r\n\t\t/** Duplicate alias validation **/\r\n\t\tthis.duplicates = false;\r\n\r\n\t\tthis.measurements = _.filter(this.measurements, (measurement) => {\r\n\t\t\treturn !measurement.hide;\r\n\t\t});\r\n\r\n\t\t_.each(this.measurements, (m) => {\r\n\t\t\tlet res = _.filter(this.measurements, (measurement) => {\r\n\t\t\t\treturn (m.alias == measurement.alias || (m.target == measurement.target && m.target)) && !m.hide;\r\n\t\t\t});\r\n\r\n\t\t\tif (res.length > 1) {\r\n\t\t\t\tthis.duplicates = true;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tonInitEditMode() {\r\n\t\tthis.addEditorTab('Options', 'public/plugins/vonage-status-panel/editor.html', 2);\r\n\t}\r\n\r\n\tsetElementHeight() {\r\n\t\tthis.$panelContainer.find('.status-panel').css('height', this.$panelContoller.height + 'px');\r\n\t}\r\n\r\n\tonRender() {\r\n\t\tthis.setElementHeight();\r\n\r\n\t\tif (this.panel.clusterName) {\r\n\t\t\tthis.panel.displayName =\r\n\t\t\t\tthis.filter('interpolateTemplateVars')(this.panel.clusterName, this.$scope)\r\n\t\t\t\t\t.replace(new RegExp(this.panel.namePrefix, 'i'), '');\r\n\t\t} else {\r\n\t\t\tthis.panel.displayName = \"\";\r\n\t\t}\r\n\r\n\r\n\r\n\t\tlet targets = this.panel.targets;\r\n\r\n\t\tthis.crit = [];\r\n\t\tthis.warn = [];\r\n\t\tthis.display = [];\r\n\t\tthis.disabled = [];\r\n\t\tthis.annotation = [];\r\n\r\n\t\t_.each(this.series, (s) => {\r\n\t\t\tlet target = _.find(targets, (target) => {\r\n\t\t\t\treturn target.alias == s.alias || target.target == s.alias;\r\n\t\t\t});\r\n\r\n\t\t\tif (!target) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\ts.alias = target.alias;\r\n\t\t\ts.url = target.url;\r\n\r\n\t\t\tlet value;\r\n\t\t\tswitch (target.aggregation) {\r\n\t\t\t\tcase 'Max':\r\n\t\t\t\t\tvalue = _.max(s.datapoints, (point) => { return point[0]; })[0];\r\n\t\t\t\t\tvalue = s.stats.max;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'Min':\r\n\t\t\t\t\tvalue = _.min(s.datapoints, (point) => { return point[0]; })[0];\r\n\t\t\t\t\tvalue = s.stats.min;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'Sum':\r\n\t\t\t\t\tvalue = 0;\r\n\t\t\t\t\t_.each(s.datapoints, (point) => { value += point[0] });\r\n\t\t\t\t\tvalue = s.stats.total;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'Avg':\r\n\t\t\t\t\tvalue = s.stats.avg;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'First':\r\n\t\t\t\t\tvalue = s.datapoints[0][0];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tvalue = s.datapoints[s.datapoints.length - 1][0];\r\n\t\t\t}\r\n\r\n\t\t\ts.display_value = value;\r\n\r\n\t\t\tif (target.displayType == \"Threshold\") {\r\n\t\t\t\tthis.handleThresholdStatus(s, target);\r\n\t\t\t}\r\n\t\t\telse if (target.displayType == \"Disable Criteria\") {\r\n\t\t\t\tthis.handleDisabledStatus(s,target);\r\n\t\t\t}\r\n\t\t\telse if (target.displayType == \"Annotation\") {\r\n\t\t\t\tthis.handleAnnotations(s, target);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis.handle_css_display();\r\n\t\tthis.parseUri();\r\n\t}\r\n\r\n\thandleThresholdStatus(series, target) {\r\n\t\tseries.thresholds = StatusPluginCtrl.parseThresholds(target);\r\n\t\tseries.inverted = series.thresholds.crit < series.thresholds.warn;\r\n\t\tseries.display = target.display;\r\n\r\n\t\tif (!series.inverted) {\r\n\t\t\tif (series.display_value >= series.thresholds.crit) {\r\n\t\t\t\tthis.crit.push(series);\r\n\t\t\t} else if (series.display_value >= series.thresholds.warn) {\r\n\t\t\t\tthis.warn.push(series);\r\n\t\t\t} else if (series.display) {\r\n\t\t\t\tthis.display.push(series);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (series.display_value <= series.thresholds.crit) {\r\n\t\t\t\tthis.crit.push(series);\r\n\t\t\t} else if (series.display_value <= series.thresholds.warn) {\r\n\t\t\t\tthis.warn.push(series);\r\n\t\t\t} else if (series.display) {\r\n\t\t\t\tthis.display.push(series);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\thandleDisabledStatus(series, target) {\r\n\r\n\t\tseries.disabledValue = target.disabledValue;\r\n\r\n\t\tif (series.display_value == series.disabledValue) {\r\n\t\t\tthis.disabled.push(series);\r\n\t\t}\r\n\t}\r\n\r\n\thandleAnnotations(series, target) {\r\n\t\tthis.annotation.push(series);\r\n\t}\r\n\r\n\thandle_css_display() {\r\n\t\tthis.$panelContainer.removeClass('error-state warn-state disabled-state ok-state no-data-state');\r\n\r\n\t\tif(this.duplicates) {\r\n\t\t\tthis.$panelContainer.addClass('error-state');\r\n\t\t} else if (this.disabled.length > 0) {\r\n\t\t\tthis.$panelContainer.addClass('disabled-state');\r\n\t\t} else if (this.crit.length > 0) {\r\n\t\t\tthis.$panelContainer.addClass('error-state');\r\n\t\t} else if (this.warn.length > 0) {\r\n\t\t\tthis.$panelContainer.addClass('warn-state');\r\n\t\t} else if((this.series == undefined || this.series.length == 0) && this.panel.isGrayOnNoData) {\r\n\t\t\tthis.$panelContainer.addClass('no-data-state');\r\n\t\t} else {\r\n\t\t\tthis.$panelContainer.addClass('ok-state');\r\n\t\t}\r\n\t}\r\n\r\n\tparseUri() {\r\n\t\tif (this.panel.links && this.panel.links.length > 0) {\r\n\t\t\tthis.uri = this.panel.links[0].dashUri + \"?\" + this.panel.links[0].params;\r\n\t\t} else {\r\n\t\t\tthis.uri = undefined;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic parseThresholds(metricOptions) {\r\n\t\tlet res = {};\r\n\r\n\t\tres.warn = metricOptions.warn;\r\n\t\tres.crit = metricOptions.crit;\r\n\r\n\t\treturn res;\r\n\t}\r\n\r\n\tonDataReceived(dataList) {\r\n\t\tthis.series = dataList.map(this.seriesHandler.bind(this));\r\n\r\n\t\tthis.render();\r\n\t}\r\n\r\n\tonDataError() {\r\n\t\tthis.crit = [];\r\n\t\tthis.warn = [];\r\n\t}\r\n\r\n\tseriesHandler(seriesData) {\r\n\t\tvar series = new TimeSeries({\r\n\t\t\tdatapoints: seriesData.datapoints,\r\n\t\t\talias: seriesData.target\r\n\t\t});\r\n\r\n\t\tseries.flotpairs = series.getFlotPairs(\"connected\");\r\n\r\n\t\treturn series;\r\n\t}\r\n\r\n\tlink(scope, elem, attrs, ctrl) {\r\n\t\tthis.$panelContainer = elem.find('.panel-container');\r\n\t\tthis.$panelContoller = ctrl;\r\n\t}\r\n}\r\n\r\nStatusPluginCtrl.templateUrl = 'module.html';\r\n"]}