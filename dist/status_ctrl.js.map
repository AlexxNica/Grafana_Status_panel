{"version":3,"sources":["../src/status_ctrl.js"],"names":["MetricsPanelCtrl","_","TimeSeries","coreModule","StatusPluginCtrl","$scope","$injector","$log","$filter","annotationsSrv","filter","displayTypes","aggregations","panel","flipTime","events","on","onRender","bind","postRefresh","onDataError","onDataReceived","onInitEditMode","fixedSpan","span","measurements","targets","duplicates","measurement","hide","each","m","res","alias","target","length","addEditorTab","$panelContainer","find","css","$panelContoller","height","setElementHeight","clusterName","displayName","replace","RegExp","namePrefix","flipCard","addClass","removeClass","crit","warn","display","disabled","annotation","series","s","url","value","aggregation","max","datapoints","point","stats","min","total","avg","display_value","displayType","handleThresholdStatus","handleDisabledStatus","handleAnnotations","autoFlip","handle_css_display","parseUri","thresholds","parseThresholds","inverted","push","disabledValue","undefined","isGrayOnNoData","links","uri","dashUri","params","dataList","map","seriesHandler","render","seriesData","flotpairs","getFlotPairs","timeoutId","clearInterval","setInterval","toggleClass","scope","elem","attrs","ctrl","metricOptions","templateUrl"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAQA,mB,kBAAAA,gB;;AAGDC,I;;AACAC,a;;AACAC,a;;;;;;;;;;;;;;;;;;;;;+BAIMC,gB;;;AACZ;AACA,8BAAYC,MAAZ,EAAoBC,SAApB,EAA+BC,IAA/B,EAAqCC,OAArC,EAA8CC,cAA9C,EAA8D;AAAA;;AAAA,qIACvDJ,MADuD,EAC/CC,SAD+C;;AAG7D;AACA,WAAKI,MAAL,GAAcF,OAAd;;AAEA,WAAKG,YAAL,GAAoB,CAAC,WAAD,EAAc,kBAAd,EAAkC,YAAlC,CAApB;AACA,WAAKC,YAAL,GAAoB,CAAC,MAAD,EAAS,OAAT,EAAkB,KAAlB,EAAyB,KAAzB,EAAgC,KAAhC,EAAuC,KAAvC,CAApB;;AAEA,WAAKC,KAAL,CAAWC,QAAX,GAAsB,MAAKD,KAAL,CAAWC,QAAX,IAAuB,CAA7C;;AAEA;AACA,WAAKC,MAAL,CAAYC,EAAZ,CAAe,QAAf,EAAyB,MAAKC,QAAL,CAAcC,IAAd,OAAzB;AACA,WAAKH,MAAL,CAAYC,EAAZ,CAAe,SAAf,EAA0B,MAAKG,WAAL,CAAiBD,IAAjB,OAA1B;AACA,WAAKH,MAAL,CAAYC,EAAZ,CAAe,YAAf,EAA6B,MAAKI,WAAL,CAAiBF,IAAjB,OAA7B;AACA,WAAKH,MAAL,CAAYC,EAAZ,CAAe,eAAf,EAAgC,MAAKK,cAAL,CAAoBH,IAApB,OAAhC;AACA,WAAKH,MAAL,CAAYC,EAAZ,CAAe,oBAAf,EAAqC,MAAKK,cAAL,CAAoBH,IAApB,OAArC;AACA,WAAKH,MAAL,CAAYC,EAAZ,CAAe,gBAAf,EAAiC,MAAKM,cAAL,CAAoBJ,IAApB,OAAjC;AAjB6D;AAkB3D;;;;mCAEW;AAAA;;AACb,UAAI,KAAKL,KAAL,CAAWU,SAAf,EAA0B;AACzB,YAAKV,KAAL,CAAWW,IAAX,GAAkB,KAAKX,KAAL,CAAWU,SAA7B;AACA;;AAED,WAAKE,YAAL,GAAoB,KAAKZ,KAAL,CAAWa,OAA/B;;AAEA;AACA,WAAKC,UAAL,GAAkB,KAAlB;;AAEA,WAAKF,YAAL,GAAoBxB,EAAES,MAAF,CAAS,KAAKe,YAAd,EAA4B,UAACG,WAAD,EAAiB;AAChE,cAAO,CAACA,YAAYC,IAApB;AACA,OAFmB,CAApB;;AAIA5B,QAAE6B,IAAF,CAAO,KAAKL,YAAZ,EAA0B,UAACM,CAAD,EAAO;AAChC,WAAIC,MAAM/B,EAAES,MAAF,CAAS,OAAKe,YAAd,EAA4B,UAACG,WAAD,EAAiB;AACtD,eAAO,CAACG,EAAEE,KAAF,IAAWL,YAAYK,KAAvB,IAAiCF,EAAEG,MAAF,IAAYN,YAAYM,MAAxB,IAAkCH,EAAEG,MAAtE,KAAkF,CAACH,EAAEF,IAA5F;AACA,QAFS,CAAV;;AAIA,WAAIG,IAAIG,MAAJ,GAAa,CAAjB,EAAoB;AACnB,eAAKR,UAAL,GAAkB,IAAlB;AACA;AACD,OARD;AASA;;;sCAEgB;AAChB,WAAKS,YAAL,CAAkB,SAAlB,EAA6B,gDAA7B,EAA+E,CAA/E;AACA;;;wCAEkB;AAClB,WAAKC,eAAL,CAAqBC,IAArB,CAA0B,eAA1B,EAA2CC,GAA3C,CAA+C,QAA/C,EAAyD,KAAKC,eAAL,CAAqBC,MAArB,GAA8B,IAAvF;AACA;;;gCAEU;AAAA;;AACV,WAAKC,gBAAL;;AAEA,UAAI,KAAK7B,KAAL,CAAW8B,WAAf,EAA4B;AAC3B,YAAK9B,KAAL,CAAW+B,WAAX,GACC,KAAKlC,MAAL,CAAY,yBAAZ,EAAuC,KAAKG,KAAL,CAAW8B,WAAlD,EAA+D,KAAKtC,MAApE,EACEwC,OADF,CACU,IAAIC,MAAJ,CAAW,KAAKjC,KAAL,CAAWkC,UAAtB,EAAkC,GAAlC,CADV,EACkD,EADlD,CADD;AAGA,OAJD,MAIO;AACN,YAAKlC,KAAL,CAAW+B,WAAX,GAAyB,EAAzB;AACA;;AAED,UAAG,KAAK/B,KAAL,CAAWmC,QAAd,EAAuB;AACrB,YAAKX,eAAL,CAAqBY,QAArB,CAA8B,cAA9B;AACD,OAFD,MAEO;AACL,YAAKZ,eAAL,CAAqBa,WAArB,CAAiC,cAAjC;AACD;;AAED,UAAIxB,UAAU,KAAKb,KAAL,CAAWa,OAAzB;;AAEA,WAAKyB,IAAL,GAAY,EAAZ;AACA,WAAKC,IAAL,GAAY,EAAZ;AACA,WAAKC,OAAL,GAAe,EAAf;AACA,WAAKC,QAAL,GAAgB,EAAhB;AACA,WAAKC,UAAL,GAAkB,EAAlB;;AAEAtD,QAAE6B,IAAF,CAAO,KAAK0B,MAAZ,EAAoB,UAACC,CAAD,EAAO;AAC1B,WAAIvB,SAASjC,EAAEqC,IAAF,CAAOZ,OAAP,EAAgB,UAACQ,MAAD,EAAY;AACxC,eAAOA,OAAOD,KAAP,IAAgBwB,EAAExB,KAAlB,IAA2BC,OAAOA,MAAP,IAAiBuB,EAAExB,KAArD;AACA,QAFY,CAAb;;AAIA,WAAI,CAACC,MAAL,EAAa;AACZ;AACA;;AAEDuB,SAAExB,KAAF,GAAUC,OAAOD,KAAjB;AACAwB,SAAEC,GAAF,GAAQxB,OAAOwB,GAAf;;AAEA,WAAIC,cAAJ;AACA,eAAQzB,OAAO0B,WAAf;AACC,aAAK,KAAL;AACCD,iBAAQ1D,EAAE4D,GAAF,CAAMJ,EAAEK,UAAR,EAAoB,UAACC,KAAD,EAAW;AAAE,iBAAOA,MAAM,CAAN,CAAP;AAAkB,UAAnD,EAAqD,CAArD,CAAR;AACAJ,iBAAQF,EAAEO,KAAF,CAAQH,GAAhB;AACA;AACD,aAAK,KAAL;AACCF,iBAAQ1D,EAAEgE,GAAF,CAAMR,EAAEK,UAAR,EAAoB,UAACC,KAAD,EAAW;AAAE,iBAAOA,MAAM,CAAN,CAAP;AAAkB,UAAnD,EAAqD,CAArD,CAAR;AACAJ,iBAAQF,EAAEO,KAAF,CAAQC,GAAhB;AACA;AACD,aAAK,KAAL;AACCN,iBAAQ,CAAR;AACA1D,WAAE6B,IAAF,CAAO2B,EAAEK,UAAT,EAAqB,UAACC,KAAD,EAAW;AAAEJ,mBAASI,MAAM,CAAN,CAAT;AAAmB,UAArD;AACAJ,iBAAQF,EAAEO,KAAF,CAAQE,KAAhB;AACA;AACD,aAAK,KAAL;AACCP,iBAAQF,EAAEO,KAAF,CAAQG,GAAhB;AACA;AACD,aAAK,OAAL;AACCR,iBAAQF,EAAEK,UAAF,CAAa,CAAb,EAAgB,CAAhB,CAAR;AACA;AACD;AACCH,iBAAQF,EAAEK,UAAF,CAAaL,EAAEK,UAAF,CAAa3B,MAAb,GAAsB,CAAnC,EAAsC,CAAtC,CAAR;AArBF;;AAwBAsB,SAAEW,aAAF,GAAkBT,KAAlB;;AAEA,WAAIzB,OAAOmC,WAAP,IAAsB,WAA1B,EAAuC;AACtC,eAAKC,qBAAL,CAA2Bb,CAA3B,EAA8BvB,MAA9B;AACA,QAFD,MAGK,IAAIA,OAAOmC,WAAP,IAAsB,kBAA1B,EAA8C;AAClD,eAAKE,oBAAL,CAA0Bd,CAA1B,EAA4BvB,MAA5B;AACA,QAFI,MAGA,IAAIA,OAAOmC,WAAP,IAAsB,YAA1B,EAAwC;AAC5C,eAAKG,iBAAL,CAAuBf,CAAvB,EAA0BvB,MAA1B;AACA;AACD,OAhDD;;AAkDA,WAAKuC,QAAL;AACA,WAAKC,kBAAL;AACA,WAAKC,QAAL;AACA;;;2CAEqBnB,M,EAAQtB,M,EAAQ;AACrCsB,aAAOoB,UAAP,GAAoBxE,iBAAiByE,eAAjB,CAAiC3C,MAAjC,CAApB;AACAsB,aAAOsB,QAAP,GAAkBtB,OAAOoB,UAAP,CAAkBzB,IAAlB,GAAyBK,OAAOoB,UAAP,CAAkBxB,IAA7D;AACAI,aAAOH,OAAP,GAAiBnB,OAAOmB,OAAxB;;AAEA,UAAI,CAACG,OAAOsB,QAAZ,EAAsB;AACrB,WAAItB,OAAOY,aAAP,IAAwBZ,OAAOoB,UAAP,CAAkBzB,IAA9C,EAAoD;AACnD,aAAKA,IAAL,CAAU4B,IAAV,CAAevB,MAAf;AACA,QAFD,MAEO,IAAIA,OAAOY,aAAP,IAAwBZ,OAAOoB,UAAP,CAAkBxB,IAA9C,EAAoD;AAC1D,aAAKA,IAAL,CAAU2B,IAAV,CAAevB,MAAf;AACA,QAFM,MAEA,IAAIA,OAAOH,OAAX,EAAoB;AAC1B,aAAKA,OAAL,CAAa0B,IAAb,CAAkBvB,MAAlB;AACA;AACD,OARD,MAQO;AACN,WAAIA,OAAOY,aAAP,IAAwBZ,OAAOoB,UAAP,CAAkBzB,IAA9C,EAAoD;AACnD,aAAKA,IAAL,CAAU4B,IAAV,CAAevB,MAAf;AACA,QAFD,MAEO,IAAIA,OAAOY,aAAP,IAAwBZ,OAAOoB,UAAP,CAAkBxB,IAA9C,EAAoD;AAC1D,aAAKA,IAAL,CAAU2B,IAAV,CAAevB,MAAf;AACA,QAFM,MAEA,IAAIA,OAAOH,OAAX,EAAoB;AAC1B,aAAKA,OAAL,CAAa0B,IAAb,CAAkBvB,MAAlB;AACA;AACD;AACD;;;0CAEoBA,M,EAAQtB,M,EAAQ;;AAEpCsB,aAAOwB,aAAP,GAAuB9C,OAAO8C,aAA9B;;AAEA,UAAIxB,OAAOY,aAAP,IAAwBZ,OAAOwB,aAAnC,EAAkD;AACjD,YAAK1B,QAAL,CAAcyB,IAAd,CAAmBvB,MAAnB;AACA;AACD;;;uCAEiBA,M,EAAQtB,M,EAAQ;AACjC,WAAKqB,UAAL,CAAgBwB,IAAhB,CAAqBvB,MAArB;AACA;;;0CAEoB;AACpB,WAAKnB,eAAL,CAAqBa,WAArB,CAAiC,8DAAjC;;AAEA,UAAG,KAAKvB,UAAR,EAAoB;AACnB,YAAKU,eAAL,CAAqBY,QAArB,CAA8B,aAA9B;AACA,OAFD,MAEO,IAAI,KAAKK,QAAL,CAAcnB,MAAd,GAAuB,CAA3B,EAA8B;AACpC,YAAKE,eAAL,CAAqBY,QAArB,CAA8B,gBAA9B;AACA,OAFM,MAEA,IAAI,KAAKE,IAAL,CAAUhB,MAAV,GAAmB,CAAvB,EAA0B;AAChC,YAAKE,eAAL,CAAqBY,QAArB,CAA8B,aAA9B;AACA,OAFM,MAEA,IAAI,KAAKG,IAAL,CAAUjB,MAAV,GAAmB,CAAvB,EAA0B;AAChC,YAAKE,eAAL,CAAqBY,QAArB,CAA8B,YAA9B;AACA,OAFM,MAEA,IAAG,CAAC,KAAKO,MAAL,IAAeyB,SAAf,IAA4B,KAAKzB,MAAL,CAAYrB,MAAZ,IAAsB,CAAnD,KAAyD,KAAKtB,KAAL,CAAWqE,cAAvE,EAAuF;AAC7F,YAAK7C,eAAL,CAAqBY,QAArB,CAA8B,eAA9B;AACA,OAFM,MAEA;AACN,YAAKZ,eAAL,CAAqBY,QAArB,CAA8B,UAA9B;AACA;AACD;;;gCAEU;AACV,UAAI,KAAKpC,KAAL,CAAWsE,KAAX,IAAoB,KAAKtE,KAAL,CAAWsE,KAAX,CAAiBhD,MAAjB,GAA0B,CAAlD,EAAqD;AACpD,YAAKiD,GAAL,GAAW,KAAKvE,KAAL,CAAWsE,KAAX,CAAiB,CAAjB,EAAoBE,OAApB,GAA8B,GAA9B,GAAoC,KAAKxE,KAAL,CAAWsE,KAAX,CAAiB,CAAjB,EAAoBG,MAAnE;AACA,OAFD,MAEO;AACN,YAAKF,GAAL,GAAWH,SAAX;AACA;AACD;;;oCAWcM,Q,EAAU;AACxB,WAAK/B,MAAL,GAAc+B,SAASC,GAAT,CAAa,KAAKC,aAAL,CAAmBvE,IAAnB,CAAwB,IAAxB,CAAb,CAAd;;AAEA,WAAKwE,MAAL;AACA;;;mCAEa;AACb,WAAKvC,IAAL,GAAY,EAAZ;AACA,WAAKC,IAAL,GAAY,EAAZ;AACA;;;mCAEauC,U,EAAY;AACzB,UAAInC,SAAS,IAAItD,UAAJ,CAAe;AAC3B4D,mBAAY6B,WAAW7B,UADI;AAE3B7B,cAAO0D,WAAWzD;AAFS,OAAf,CAAb;;AAKAsB,aAAOoC,SAAP,GAAmBpC,OAAOqC,YAAP,CAAoB,WAApB,CAAnB;;AAEA,aAAOrC,MAAP;AACA;;;kCAEY;AACZ,UAAG,KAAKsC,SAAR,EAAmBC,cAAc,KAAKD,SAAnB;AACnB;;;gCAEU;AAAA;;AACV,UAAI,KAAKA,SAAT,EAAoBC,cAAc,KAAKD,SAAnB;AACpB,UAAI,KAAKjF,KAAL,CAAWmC,QAAX,KAAwB,KAAKG,IAAL,CAAUhB,MAAV,GAAmB,CAAnB,IAAwB,KAAKiB,IAAL,CAAUjB,MAAV,GAAmB,CAAnE,CAAJ,EAA2E;AAC1E,YAAK2D,SAAL,GAAiBE,YAAY,YAAM;AAClC,eAAK3D,eAAL,CAAqB4D,WAArB,CAAiC,SAAjC;AACA,QAFgB,EAEd,KAAKpF,KAAL,CAAWC,QAAX,GAAsB,IAFR,CAAjB;AAGA;AACD;;;0BAEIoF,K,EAAOC,I,EAAMC,K,EAAOC,I,EAAM;AAC9B,WAAKhE,eAAL,GAAuB8D,KAAK7D,IAAL,CAAU,kBAAV,CAAvB;AACA,WAAKD,eAAL,CAAqBY,QAArB,CAA8B,SAA9B;AACA,WAAKT,eAAL,GAAuB6D,IAAvB;AACA;;;qCAhDsBC,a,EAAe;AACrC,UAAItE,MAAM,EAAV;;AAEAA,UAAIoB,IAAJ,GAAWkD,cAAclD,IAAzB;AACApB,UAAImB,IAAJ,GAAWmD,cAAcnD,IAAzB;;AAEA,aAAOnB,GAAP;AACA;;;;KA7MoChC,gB;;;;AAyPtCI,oBAAiBmG,WAAjB,GAA+B,aAA/B","file":"status_ctrl.js","sourcesContent":["import {MetricsPanelCtrl} from \"app/plugins/sdk\";\nimport \"app/plugins/panel/graph/legend\";\nimport \"app/plugins/panel/graph/series_overrides_ctrl\";\nimport _ from \"lodash\";\nimport TimeSeries from \"app/core/time_series2\";\nimport coreModule from \"app/core/core_module\"\n\nimport './css/status_panel.css!';\n\nexport class StatusPluginCtrl extends MetricsPanelCtrl {\n\t/** @ngInject */\n\tconstructor($scope, $injector, $log, $filter, annotationsSrv) {\n\t\tsuper($scope, $injector);\n\n\t\t//this.log = $log.debug;\n\t\tthis.filter = $filter;\n\n\t\tthis.displayTypes = ['Threshold', 'Disable Criteria', 'Annotation'];\n\t\tthis.aggregations = ['Last', 'First', 'Max', 'Min', 'Sum', 'Avg'];\n\n\t\tthis.panel.flipTime = this.panel.flipTime || 5;\n\n\t\t/** Bind events to functions **/\n\t\tthis.events.on('render', this.onRender.bind(this));\n\t\tthis.events.on('refresh', this.postRefresh.bind(this));\n\t\tthis.events.on('data-error', this.onDataError.bind(this));\n\t\tthis.events.on('data-received', this.onDataReceived.bind(this));\n\t\tthis.events.on('data-snapshot-load', this.onDataReceived.bind(this));\n\t\tthis.events.on('init-edit-mode', this.onInitEditMode.bind(this));\n  \t}\n\n\tpostRefresh() {\n\t\tif (this.panel.fixedSpan) {\n\t\t\tthis.panel.span = this.panel.fixedSpan;\n\t\t}\n\n\t\tthis.measurements = this.panel.targets;\n\n\t\t/** Duplicate alias validation **/\n\t\tthis.duplicates = false;\n\n\t\tthis.measurements = _.filter(this.measurements, (measurement) => {\n\t\t\treturn !measurement.hide;\n\t\t});\n\n\t\t_.each(this.measurements, (m) => {\n\t\t\tlet res = _.filter(this.measurements, (measurement) => {\n\t\t\t\treturn (m.alias == measurement.alias || (m.target == measurement.target && m.target)) && !m.hide;\n\t\t\t});\n\n\t\t\tif (res.length > 1) {\n\t\t\t\tthis.duplicates = true;\n\t\t\t}\n\t\t});\n\t}\n\n\tonInitEditMode() {\n\t\tthis.addEditorTab('Options', 'public/plugins/vonage-status-panel/editor.html', 2);\n\t}\n\n\tsetElementHeight() {\n\t\tthis.$panelContainer.find('.status-panel').css('height', this.$panelContoller.height + 'px');\n\t}\n\n\tonRender() {\n\t\tthis.setElementHeight();\n\n\t\tif (this.panel.clusterName) {\n\t\t\tthis.panel.displayName =\n\t\t\t\tthis.filter('interpolateTemplateVars')(this.panel.clusterName, this.$scope)\n\t\t\t\t\t.replace(new RegExp(this.panel.namePrefix, 'i'), '');\n\t\t} else {\n\t\t\tthis.panel.displayName = \"\";\n\t\t}\n\n\t\tif(this.panel.flipCard){\n\t\t  this.$panelContainer.addClass(\"effect-hover\");\n\t\t} else {\n\t\t  this.$panelContainer.removeClass(\"effect-hover\");\n\t\t}\n\n\t\tlet targets = this.panel.targets;\n\n\t\tthis.crit = [];\n\t\tthis.warn = [];\n\t\tthis.display = [];\n\t\tthis.disabled = [];\n\t\tthis.annotation = [];\n\n\t\t_.each(this.series, (s) => {\n\t\t\tlet target = _.find(targets, (target) => {\n\t\t\t\treturn target.alias == s.alias || target.target == s.alias;\n\t\t\t});\n\n\t\t\tif (!target) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\ts.alias = target.alias;\n\t\t\ts.url = target.url;\n\n\t\t\tlet value;\n\t\t\tswitch (target.aggregation) {\n\t\t\t\tcase 'Max':\n\t\t\t\t\tvalue = _.max(s.datapoints, (point) => { return point[0]; })[0];\n\t\t\t\t\tvalue = s.stats.max;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'Min':\n\t\t\t\t\tvalue = _.min(s.datapoints, (point) => { return point[0]; })[0];\n\t\t\t\t\tvalue = s.stats.min;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'Sum':\n\t\t\t\t\tvalue = 0;\n\t\t\t\t\t_.each(s.datapoints, (point) => { value += point[0] });\n\t\t\t\t\tvalue = s.stats.total;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'Avg':\n\t\t\t\t\tvalue = s.stats.avg;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'First':\n\t\t\t\t\tvalue = s.datapoints[0][0];\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tvalue = s.datapoints[s.datapoints.length - 1][0];\n\t\t\t}\n\n\t\t\ts.display_value = value;\n\n\t\t\tif (target.displayType == \"Threshold\") {\n\t\t\t\tthis.handleThresholdStatus(s, target);\n\t\t\t}\n\t\t\telse if (target.displayType == \"Disable Criteria\") {\n\t\t\t\tthis.handleDisabledStatus(s,target);\n\t\t\t}\n\t\t\telse if (target.displayType == \"Annotation\") {\n\t\t\t\tthis.handleAnnotations(s, target);\n\t\t\t}\n\t\t});\n\n\t\tthis.autoFlip();\n\t\tthis.handle_css_display();\n\t\tthis.parseUri();\n\t}\n\n\thandleThresholdStatus(series, target) {\n\t\tseries.thresholds = StatusPluginCtrl.parseThresholds(target);\n\t\tseries.inverted = series.thresholds.crit < series.thresholds.warn;\n\t\tseries.display = target.display;\n\n\t\tif (!series.inverted) {\n\t\t\tif (series.display_value >= series.thresholds.crit) {\n\t\t\t\tthis.crit.push(series);\n\t\t\t} else if (series.display_value >= series.thresholds.warn) {\n\t\t\t\tthis.warn.push(series);\n\t\t\t} else if (series.display) {\n\t\t\t\tthis.display.push(series);\n\t\t\t}\n\t\t} else {\n\t\t\tif (series.display_value <= series.thresholds.crit) {\n\t\t\t\tthis.crit.push(series);\n\t\t\t} else if (series.display_value <= series.thresholds.warn) {\n\t\t\t\tthis.warn.push(series);\n\t\t\t} else if (series.display) {\n\t\t\t\tthis.display.push(series);\n\t\t\t}\n\t\t}\n\t}\n\n\thandleDisabledStatus(series, target) {\n\n\t\tseries.disabledValue = target.disabledValue;\n\n\t\tif (series.display_value == series.disabledValue) {\n\t\t\tthis.disabled.push(series);\n\t\t}\n\t}\n\n\thandleAnnotations(series, target) {\n\t\tthis.annotation.push(series);\n\t}\n\n\thandle_css_display() {\n\t\tthis.$panelContainer.removeClass('error-state warn-state disabled-state ok-state no-data-state');\n\n\t\tif(this.duplicates) {\n\t\t\tthis.$panelContainer.addClass('error-state');\n\t\t} else if (this.disabled.length > 0) {\n\t\t\tthis.$panelContainer.addClass('disabled-state');\n\t\t} else if (this.crit.length > 0) {\n\t\t\tthis.$panelContainer.addClass('error-state');\n\t\t} else if (this.warn.length > 0) {\n\t\t\tthis.$panelContainer.addClass('warn-state');\n\t\t} else if((this.series == undefined || this.series.length == 0) && this.panel.isGrayOnNoData) {\n\t\t\tthis.$panelContainer.addClass('no-data-state');\n\t\t} else {\n\t\t\tthis.$panelContainer.addClass('ok-state');\n\t\t}\n\t}\n\n\tparseUri() {\n\t\tif (this.panel.links && this.panel.links.length > 0) {\n\t\t\tthis.uri = this.panel.links[0].dashUri + \"?\" + this.panel.links[0].params;\n\t\t} else {\n\t\t\tthis.uri = undefined;\n\t\t}\n\t}\n\n\tstatic parseThresholds(metricOptions) {\n\t\tlet res = {};\n\n\t\tres.warn = metricOptions.warn;\n\t\tres.crit = metricOptions.crit;\n\n\t\treturn res;\n\t}\n\n\tonDataReceived(dataList) {\n\t\tthis.series = dataList.map(this.seriesHandler.bind(this));\n\n\t\tthis.render();\n\t}\n\n\tonDataError() {\n\t\tthis.crit = [];\n\t\tthis.warn = [];\n\t}\n\n\tseriesHandler(seriesData) {\n\t\tvar series = new TimeSeries({\n\t\t\tdatapoints: seriesData.datapoints,\n\t\t\talias: seriesData.target\n\t\t});\n\n\t\tseries.flotpairs = series.getFlotPairs(\"connected\");\n\n\t\treturn series;\n\t}\n\n\t$onDestroy() {\n\t\tif(this.timeoutId) clearInterval(this.timeoutId);\n\t}\n\n\tautoFlip() {\n\t\tif (this.timeoutId) clearInterval(this.timeoutId);\n\t\tif (this.panel.flipCard && (this.crit.length > 0 || this.warn.length > 0)) {\n\t\t\tthis.timeoutId = setInterval(() => {\n\t\t\t\tthis.$panelContainer.toggleClass(\"flipped\");\n\t\t\t}, this.panel.flipTime * 1000);\n\t\t}\n\t}\n\n\tlink(scope, elem, attrs, ctrl) {\n\t\tthis.$panelContainer = elem.find('.panel-container');\n\t\tthis.$panelContainer.addClass(\"st-card\");\n\t\tthis.$panelContoller = ctrl;\n\t}\n}\n\nStatusPluginCtrl.templateUrl = 'module.html';\n"]}